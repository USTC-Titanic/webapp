<!DOCTYPE html>
<html>
<head>
	<title>实战教程</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link href="https://cdn.bootcss.com/twitter-bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet">
</head>

<style type="text/css">
	/*减少连接*/
	/*<link rel="stylesheet" href="/static/mynavbar.css">*/
	/*<link rel="stylesheet" href="/static/ml_practice/ml_practice.css">*/
	h3 {
		margin-top: 8px;
	}

	body {
		padding-top: 64px;
	}

	body > header{
		background-color: #000;
	}

	#mybrand{
		width: 20%;
		padding-left: 16px;
		padding-right: 16px;
	}

	#navbarCollapse{
		width: 80%;
		padding-left: 24px;
	}

	body > main > article {
		width: 80%;
		float: right;
		margin-bottom: 96px;
		padding: 8px;
		word-wrap: break-word;
	}

	body > main > article > section {
		padding: 0, 8px, 0, 8px;
	}

	section{
		width: 100%;
	}

	aside {
		width: 20%;
		float: left;
		padding: 16px;
	}

	#sidebar {
		border: 1px solid #E8E8E8;
	}

	#sidebar-title {
		background: linear-gradient(#ffffff, #f3f3f3);
		height: 48px;

		/* TODO: flex, 学习 flex 布局 */
		display: flex;
		display: -webkit-flex;

		/* vertical */
		align-items: center;
		/* horizontal */
		justify-content: center;
	}

	#sidebar-menu {
		padding: 16px;
		text-align: center;
	}

	#sidebar-menu > li{
		list-style-type: none;
		line-height: 32px;
		cursor: pointer;
		color: #777;
	}

	#sidebar-menu > li:hover{
		color: #000;
	}

	.my_pad_4{
		padding: 4px;
	}

	.my_pad_8{
		padding: 8px;
	}

	.my_pad_32{
		padding: 32px;
	}

	.my_width_100pct{
		width: 100%;
	}

	.result-style{
		color:red;
	}

	pre{
		white-space: pre-wrap;
	}

	.grid-container{
		display: grid;
		grid-template-columns: auto auto auto auto;
	}

	.grid-header{
		border: 1px solid;
		grid-column: 1 / 5;
	}

	.grid-body{
		border: 1px solid;
		text-align: left;
	}

	.row{
		margin: 0px;
	}

	.row > .col{
		border: 1px solid rgba(86,61,124,.2);
	}

	article > section{
		padding-bottom: 32px;
	}

	#mychart1, #mychart2, #mychart3, #mychart4, #mychart5{
		width: 640px;
		height: 400px;
	}

	[v-cloak] {
		display: none;
	}
</style>

<body>
		<header id="myheader" class="navbar navbar-expand-md navbar-dark fixed-top">
		<div class="container">
			<section id="mybrand">
				<a class="navbar-brand" href="/">机器学习</a>
			</section>
			<button class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#navbarCollapse">
				<span class="navbar-toggler-icon"></span>
			</button>
			<section class="collapse navbar-collapse justify-content-between" id="navbarCollapse">
				<ul class="navbar-nav">
					<li class="nav-item mr-4">
						<a class="nav-link" href="/practice">实战教程</a>
					</li>
					<li class="nav-item mr-4">
						<a class="nav-link" href="/news">新闻资讯</a>
					</li>
					<li class="nav-item mr-4">
						<a class="nav-link" href="/blog">开发日志</a>
					</li>
				</ul>
				<div v-cloak v-if="nickname">
					<ul class="navbar-nav">
						<li class="nav-item">
							<a class="nav-link" href="/profile">{{ nickname }}</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="/signout">注销</a>
						</li>
					</ul>
				</div>
				<div v-cloak v-else>
					<ul class="navbar-nav">
						<li class="nav-item">
							<a class="nav-link" href="/signin">登录</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="/signup">注册</a>
						</li>
					</ul>
				</div>
			</section>
		</div>
	</header>

	<main class="container" id="practice">
		<aside>
			<section id="sidebar">
				<div id="sidebar-title">真题训练</div>
				<div>
					<ul id="sidebar-menu">
						<li v-on:click="article_number = 1">赛题简介</li>
						<li v-on:click="article_number = 2">数据分析</li>
						<li v-on:click="article_number = 3">特征工程</li>
						<li v-on:click="article_number = 4">模型运用</li>
					</ul>
				</div>
			</section>
		</aside>
		<article class="row">
			<section v-show="article_number === 1" id="article1">
				<h3 id="title1">赛题简介</h3>
				<div id="content1">
					<p>
						泰坦尼克号沉没是历史上最臭名昭着的沉船之一。 1912年4月15日，在她的处女航中，泰坦尼克号在与冰山相撞后沉没，在2224名乘客和机组人员中造成1502人死亡。这场耸人听闻的悲剧震惊了国际社会，并为船舶制定了更好的安全规定。沉船造成这种生命损失的原因之一是乘客和船员没有足够的救生艇。尽管幸存下来有一些幸运因素，但有些人比其他人更容易生存，例如妇女，儿童和上层阶级。
					</p>
					<p>
						在这一挑战中，我们要求分析什么样的乘客更可能存活下来。特别是，要求运用机器学习工具来预测哪些乘客能够幸免于悲剧。
					</p>
					<p>
						这是一个实践分类问题的绝佳机会。基本背景是泰坦尼克号是一艘英国客轮，于1912年在北大西洋沉没，在她与冰山相撞之后从南安普敦到纽约市的处女航。在估计的2,224名乘客和船员中，超过1,500人死亡，使其成为现代历史上和平时期最致命的商业海洋灾难之一。 泰坦尼克号是她服役时最大的船舶，也是白星航线运营的三艘奥运级海洋内衬中的第二艘。她是由贝尔法斯特的Harland和Wolff造船厂建造的。当时造船厂的首席海军设计师托马斯安德鲁斯在灾难中丧生。
					</p>
					
				</div>
			</section>

			<section v-show="article_number === 2" id="article2">
				<h3 id="title2">数据分析</h3>
				<div id="content2">
					<p>
						概览
					</p>
					<p>
						数据集被分为两部分
					</p>
					<ul>
						<li>
							训练集 (train.csv)
						</li>
						<li>
							测试集 (test.csv)
						</li>
					</ul>
					<p>
						泰坦尼克数据集中，训练集有891条，测试集有418条。输入特征包括PassengerID（ID），Pclass（客舱等级，较为重要），Name（姓名，可提取出更多信息），Sex（性别，较为重要），Age（年龄，较为重要），Parch（直系亲友），SibSp（旁系），Ticket（票编号），Fare（票价），Cabin（客舱编号）和Embarked（上船的港口编号）。
					</p>
					<p>
						在这一挑战中，我们要求分析什么样的乘客更可能存活下来。特别是，要求运用机器学习工具来预测哪些乘客能够幸免于悲剧。
					</p>
				</div>
			</section>

			<section v-show="article_number === 3" id="article3">
				<h3 id="title3">特征工程</h3>
				<div id="content3">
					<h6>数据预处理</h6>
					<p>通过数据质量分析，检查原始数据中是否存在脏数据，脏数据包括：缺失值，异常值，不一致的值，重复数据及含有特殊符号的值。本题目中主要是缺失值的处理。</p>

					<p>首先查看每一列的数据以及数据类型</p>
					<div class="row">
						<div class="col">Age</div>
						<div class="col">1046</div>
						<div class="col">non-null</div>
						<div class="col">float64</div>
					</div>
					<div class="row">
						<div class="col">Cabin</div>
						<div class="col">295</div>
						<div class="col"> non-null</div>
						<div class="col">object</div>
					</div>
					<div class="row">
						<div class="col">Embarked</div>
						<div class="col">1307</div>
						<div class="col">non-null</div>
						<div class="col">object</div>
					</div>
					<div class="row">
						<div class="col">Fare</div>
						<div class="col">1308</div>
						<div class="col">non-null</div>
						<div class="col">float64</div>
					</div>
					<div class="row">
						<div class="col">Name</div>
						<div class="col">1309</div>
						<div class="col">non-null</div>
						<div class="col">object</div>
					</div>
					<div class="row">
						<div class="col">Parch</div>
						<div class="col">1309</div>
						<div class="col">non-null</div>
						<div class="col">int64</div>
					</div>
					<div class="row">
						<div class="col">PassengerId</div>
						<div class="col">1309</div>
						<div class="col">non-null</div>
						<div class="col">int64</div>
					</div>
					<div class="row">
						<div class="col">Pclass</div>
						<div class="col">1309</div>
						<div class="col">non-null</div>
						<div class="col">int64</div>
					</div>
					<div class="row">
						<div class="col">Sex</div>
						<div class="col">1309</div>
						<div class="col">non-null</div>
						<div class="col">object</div>
					</div>
					<div class="row">
						<div class="col">SibSp</div>
						<div class="col">1309</div>
						<div class="col">non-null</div>
						<div class="col">int64</div>
					</div>
					<div class="row">
						<div class="col">Survived</div>
						<div class="col">891</div>
						<div class="col">non-null</div>
						<div class="col">float64</div>
					</div>
					<div class="row">
						<div class="col">Ticket</div>
						<div class="col">1309</div>
						<div class="col">non-null</div>
						<div class="col">object</div>
					</div>
					<br>

					<p>缺失值分析：</p>
					<div class="row">
						<div class="col">属性</div>
						<div class="col">含义</div>
						<div class="col">数据总数</div>
						<div class="col">缺失值</div>
						<div class="col">缺失率</div>
					</div>
					<div class="row">
						<div class="col">Age</div>
						<div class="col">年龄</div>
						<div class="col">1046</div>
						<div class="col">263</div>
						<div class="col">20.09%</div>
					</div>
					<div class="row">
						<div class="col">Cabin</div>
						<div class="col">船舱号</div>
						<div class="col">295</div>
						<div class="col">1014</div>
						<div class="col">77.46%</div>
					</div>
					<div class="row">
						<div class="col">Embarked</div>
						<div class="col">登船港口</div>
						<div class="col">1307</div>
						<div class="col">2</div>
						<div class="col">0.15%</div>
					</div>
					<div class="row">
						<div class="col">Fare</div>
						<div class="col">船票价格</div>
						<div class="col">1308</div>
						<div class="col">1</div>
						<div class="col">0.08%</div>
					</div>
					<div class="row">
						<div class="col">Name</div>
						<div class="col">姓名</div>
						<div class="col">1309</div>
						<div class="col">0</div>
						<div class="col">0</div>
					</div>
					<div class="row">
						<div class="col">Parch</div>
						<div class="col">父母/子女数目</div>
						<div class="col">1309</div>
						<div class="col">0</div>
						<div class="col">0</div>
					</div>
					<div class="row">
						<div class="col">PassengerID</div>
						<div class="col">乘客编号</div>
						<div class="col">1309</div>
						<div class="col">0</div>
						<div class="col">0</div>
					</div>
					<div class="row">
						<div class="col">Pclass</div>
						<div class="col">船舱等级</div>
						<div class="col">1309</div>
						<div class="col">0</div>
						<div class="col">0</div>
					</div>
					<div class="row">
						<div class="col">Sex</div>
						<div class="col">性别</div>
						<div class="col">1309</div>
						<div class="col">0</div>
						<div class="col">0</div>
					</div>
					<div class="row">
						<div class="col">SibSp</div>
						<div class="col">兄弟姐妹、配偶数列</div>
						<div class="col">1309</div>
						<div class="col">0</div>
						<div class="col">0</div>
					</div>
					<div class="row">
						<div class="col">Ticket</div>
						<div class="col">船票号码</div>
						<div class="col">1309</div>
						<div class="col">0</div>
						<div class="col">0</div>
					</div>
					<div class="row">
						<div class="col">Surviied</div>
						<div class="col">存活(1)/死亡(0)</div>
						<div class="col">891</div>
						<div class="col">0</div>
						<div class="col">0</div>
					</div>
					<br>

					<p>需要进行缺失值处理的有: Age, Cabin, Embarked, Fare</p>
					<div class="row">
						<div class="col">属性</div>
						<div class="col">处理方法</div>
						<div class="col">说明</div>
					</div>

					<div class="row">
						<div class="col">Age</div>
						<div class="col">平均值填充</div>
						<div class="col">Age 是数值型, 暂时用平均值填充</div>
					</div>

					<div class="row">
						<div class="col">Cablin</div>
						<div class="col">舍弃</div>
						<div class="col">Cablin 缺失较多, 难以估计</div>
					</div>

					<div class="row">
						<div class="col">Embarked</div>
						<div class="col">众数填充</div>
						<div class="col">Embarked 缺失较少且是分类数据, 众数是'S'</div>
					</div>

					<div class="row">
						<div class="col">Fare</div>
						<div class="col">平均值填充</div>
						<div class="col">Fare 是数值型, 只缺失一行数据</div>
					</div>
					<br>

					<p>图表分析</p>
					<div class="row justify-content-center">
						<div class="col">
							<div id="mychart1" class="my_pad_32"></div>
						</div>
					</div>
					
					<div class="row justify-content-center">
						<div class="col">
							<div id="mychart2" class="my_pad_32"></div>
						</div>
					</div>

					<div class="row justify-content-center">
						<div class="col">
							<div id="mychart3" class="my_pad_32"></div>
						</div>
					</div>

					<div class="row justify-content-center">
						<div class="col">
							<div id="mychart4" class="my_pad_32"></div>
						</div>
					</div>

					<div class="row justify-content-center">
						<div class="col">
							<div id="mychart5" class="my_pad_32"></div>
						</div>
					</div>

				</div>
			</section>

			<section v-show="article_number === 4" id="article4">
				<h3 id="title4">模型运用</h3>
				<div id="content4">
					<div class="row justify-content-center my_pad_32">
						<div class="col-auto">惠更斯号乘客信息</div>
					</div>

					<div class="row justify-content-center">
						<div class="col-auto">
							<form v-on:submit.prevent="do_submit_passenger_info">
								<div class="form-row my_pad_4">
									<div class="col">
										<input class="form-control" placeholder="船舱等级" v-model="Pclass" required>
									</div>
								</div>

								<div class="form-row my_pad_4">
									<div class="col">
										<input class="form-control" placeholder="姓名" v-model="Name" required>
									</div>
								</div>

								<div class="form-row my_pad_4">
									<div class="col">
										<input class="form-control" placeholder="性别" v-model="Sex" required>
									</div>
								</div>

								<div class="form-row my_pad_4">
									<div class="col">
										<input class="form-control" placeholder="年龄" v-model="Age" required>
									</div>
								</div>

								<div class="form-row my_pad_4">
									<div class="col">
										<input class="form-control" placeholder="兄弟姐妹数量" v-model="SibSp" required>
									</div>
								</div>

								<div class="form-row my_pad_4">
									<div class="col">
										<input class="form-control" placeholder="父母/孩子数量" v-model="Parch" required>
									</div>
								</div>

								<div class="form-row my_pad_4">
									<div class="col text-left">
										<input class="form-control result-style" placeholder="生存指数: " v-model="response" disabled>
									</div>
								</div>

								<div class="form-row my_pad_4">
									<div class="col">
										<button class="btn btn-primary my_width_100pct">提交</button>
									</div>
								</div>

							</form>
						</div>
					</div>

				</div>
			</section>

		</article>
	</main>
</body>

<section class="row justify-content-end">
	<div class="col-1 text-right">
		<button type="button" id="go-to-top" class="btn btn-sm btn-outline-primary" onclick="goToTop()" style="display: none; position: fixed; bottom: 80px; right: 16px;">↑</button>
	</div>
</section>

<script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.slim.min.js"></script>
<script src="https://cdn.bootcss.com/twitter-bootstrap/4.0.0/js/bootstrap.min.js"></script>
<script src="https://cdn.bootcss.com/vue/2.5.13/vue.js"></script>
<script src="https://cdn.bootcss.com/axios/0.17.1/axios.js"></script>
<script src="https://cdn.bootcss.com/echarts/4.2.1-rc1/echarts.min.js"></script>

<script type="text/javascript">
	'use strict';

	var myheader = new Vue({
		el: '#myheader',
		data:{
			nickname: '',
		},
		created: function(){
			let cookie = document.cookie;
			let cookie_list = cookie.split(';')
			for(let item of cookie_list){
				if( item.indexOf('nickname=') != -1 ){
					this.nickname = item.split('=')[1];
				}
			}
		}
	});

	var mycontent1 = "The sinking of the RMS Titanic is one of the most infamous shipwrecks in history.  On April 15, 1912, during her maiden voyage, the Titanic sank after colliding with an iceberg, killing 1502 out of 2224 passengers and crew. This sensational tragedy shocked the international community and led to better safety regulations for ships.\
	\
	One of the reasons that the shipwreck led to such loss of life was that there were not enough lifeboats for the passengers and crew. Although there was some element of luck involved in surviving the sinking, some groups of people were more likely to survive than others, such as women, children, and the upper-class.\
	\
	In this challenge, we ask you to complete the analysis of what sorts of people were likely to survive. In particular, we ask you to apply the tools of machine learning to predict which passengers survived the tragedy.\
	\
	Practice Skills\
	Binary classification\
	Python and R basics\
	\
	RMS Titanic was a British passenger liner that sank in the North Atlantic Ocean in 1912, after colliding with an iceberg during her maiden voyage from Southampton to New York City. Of the estimated 2,224 passengers and crew aboard, more than 1,500 died, making it one of modern history's deadliest commercial marine disasters during peacetime. RMS Titanic was the largest ship afloat at the time she entered service and was the second of three Olympic-class ocean liners operated by the White Star Line. She was built by the Harland and Wolff shipyard in Belfast. Thomas Andrews, chief naval architect of the shipyard at the time, died in the disaster.[4]";

	var app = new Vue({
		el: '#practice',
		data:{
			article_number: 1,
			mycontent1: mycontent1,
			pathname: '',
			Pclass: '',
			Name: '',
			Sex: '',
			Age: '',
			SibSp: '',
			Parch: '',
			form: '',
			response: '',
		},
		created: function(){
			this.pathname = document.location.pathname;
			this.redirectPath = document.location.search;
		},
		methods:{
			do_submit_passenger_info: function(){
				var self = this;
				self.form = {
					Pclass: self.Pclass,
					Name: self.Name,
					Sex: self.Sex,
					Age: self.Age,
					SibSp: self.SibSp,
					Parch: self.Parch,
				}
				var APIpost = `/predict`;
				console.log(APIpost);

				axios.post(APIpost, self.form)
					.then(function(resp){
						console.log(resp);
						self.response = '生存指数: ' + resp.data;
					})
			}
		}
	})

	// echarts visualization



	var mychart1 = echarts.init(document.getElementById('mychart1'));
	var option = {
		title:{
			text: '生存率',
			x: 'center',
		},
		tooltip:{
			trigger: 'item',
			formatter: '{c}%'
		},
		series:[{
			name: '生存率',
			type: 'pie',
			// 半径radius 是 min(width, heigh) 的 60%
			radius: '50%',
			// 也可以直接输入绝对值
			data: [
				{value: 38.38, name: '生存', itemStyle:{color: '#34c726'}},
				{value: 61.62, name: '遇难', itemStyle:{color: '#767676'}},
			]
		}],
	};
	mychart1.setOption(option);



	var mychart2 = echarts.init(document.getElementById('mychart2'));
	option = {
		title:{
			text: '性别与生存率的关系'
		},
		tooltip:{
			trigger: 'item',
			formatter: '{c}'
		},
		legend:{
			data: ['生存', '遇难'],
		},
		xAxis:{
			data: ['男性', '女性'],
		},
		yAxis:{
		},
		series:[
			{
				name: '生存',
				type: 'bar',
				data: [110, 230],
				barWidth: 50,
				itemStyle:{color: '#34c726'},
				barGap: "10%",
			},
			{
				name: '遇难',
				type: 'bar',
				data: [470, 90],
				barWidth: 50,
				itemStyle:{color: '#767676'},
				barGap: "10%",
			},

		]
	};
	mychart2.setOption(option);

	var mychart3 = echarts.init(document.getElementById('mychart3'));
	option = {
		title:{
			text: '船舱等级与生存率的关系',
			x: 'center',
		},
		tooltip:{
			trigger: 'item',
			formatter: '{c}'
		},
		legend:{
			data: ['生存', '遇难'],
			x: '75%',
		},
		xAxis:{
			data: ['一等舱', '二等舱', '三等舱'],
		},
		yAxis:{
		},
		series:[
			{
				name: '生存',
				type: 'bar',
				data: [140, 90, 115],
				barWidth: 50,
				itemStyle:{color: '#34c726'},
				barGap: "10%",
			},
			{
				name: '遇难',
				type: 'bar',
				data: [80, 100, 375],
				barWidth: 50,
				itemStyle:{color: '#767676'},
				barGap: "10%",
			}
		]
	};
	mychart3.setOption(option);

	var mychart4 = echarts.init(document.getElementById('mychart4'));
	option = {
		title:{
			text: '上船港口与生存率的关系',
			x: 'center',
		},
		tooltip:{
			trigger: 'item',
			formatter: '{c}'
		},
		legend:{
			data: ['生存', '遇难'],
			x: '75%',
		},
		xAxis:{
			data: ['南安普顿', '瑟堡', '昆士顿'],
		},
		yAxis:{
		},
		series:[
			{
				name: '生存',
				type: 'bar',
				data: [215, 95, 35],
				barWidth: 50,
				itemStyle:{color: '#34c726'},
				barGap: "10%",
			},
			{
				name: '遇难',
				type: 'bar',
				data: [425, 75, 100],
				barWidth: 50,
				itemStyle:{color: '#767676'},
				barGap: "10%",
			}
		]
	};
	mychart4.setOption(option);



	var mychart5 = echarts.init(document.getElementById('mychart5'));
	option = {
		title:{
			text: '船上亲人数量与生存率的关系',
			x: 'center',
		},
		tooltip:{
			trigger: 'item',
			formatter: '{c}'
		},
		legend:{
			data: ['生存', '遇难'],
			x: '75%',
		},
		xAxis:{
			data: ['0', '1', '2', '3', '4', '5'],
		},
		yAxis:{
		},
		series:[
			{
				name: '生存',
				type: 'bar',
				data: [205, 110, 10, 3, 3, 1],
				barWidth: 30,
				itemStyle:{color: '#34c726'},
				barGap: "5%",
			},
			{
				name: '遇难',
				type: 'bar',
				data: [400, 98, 12, 11, 12, 3],
				barWidth: 30,
				itemStyle:{color: '#767676'},
				barGap: "5%",
			}
		]
	};
	mychart5.setOption(option);

	// When the user scrolls down 20px from the top of the document, show the button
	window.onscroll = function(){
		if (document.body.scrollTop > 100 || document.documentElement.scrollTop > 100) {
			document.getElementById("go-to-top").style.display = "block";
		} else {
			document.getElementById("go-to-top").style.display = "none";
		}
	};

	// https://www.w3schools.com/tags/ev_onclick.asp
	// http://www.w3school.com.cn/jsref/met_win_setinterval.asp
	function goToTop(){
		let t = setInterval( function(){
			if( document.documentElement.scrollTop <= 0 ){
				clearInterval(t);
			}else{
				document.documentElement.scrollTop -= 40;
			}
		}, 20);
	};
</script>

</html>
